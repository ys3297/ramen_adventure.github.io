---
title: "Rating by Brands"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
library(tidyverse)
library(knitr)
library(dplyr)
library(ggridges)
library(plotly)

opts_chunk$set(
	fig.width = 10, 
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

```{r clean, include=FALSE}
tidy_ramen = 
  read_csv("./ramen-ratings.csv") %>% 
  janitor::clean_names() %>% 
  separate(top_ten, into = c("year", "rank"), sep = " #", convert = TRUE) %>% 
  mutate(
    style = factor(style),
    country = factor(country),
    brand = factor(brand),
    stars = as.numeric(stars)
  )
```

---
## Background Introduction 
In this Ramen dataset, there are **`r nrow(count(tidy_ramen, brand))`** brands.

## Brands with more than 30 varieties

Here are brands which have more than 30 varieties!
```{r, echo=FALSE, message=FALSE, warning=FALSE}
most_common = 
  tidy_ramen %>%
  count(brand) %>%
  mutate(brand = fct_reorder(brand, n)) %>%
  filter(n > 30) %>%
  plot_ly(x = ~brand, y = ~n, color = ~brand, type = "bar", colors = "viridis") 

most_common
```

As shown in the above plot, *Nissin* has the widest variety with 381 types of flavor among all of the brands in this dataset. 

The 5 most common brands are:

<img src="pictures/nissin.jpg" style="width:15%"> <img src="pictures/nongshim.jpg" style="width:15%"> <img src="pictures/maruchan.png" style="width:15%"> <img src="pictures/mama.jpg" style="width:15%"> <img src="pictures/paldo.png" style="width:15%">

Below are the distribution plots of stars for these 5 most common brands

```{r, echo=FALSE, message=FALSE}
distri_most_common = 
  tidy_ramen %>%
  drop_na(stars) %>%
  filter(brand %in% c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin")) %>%
  mutate(brand = forcats::fct_relevel(brand, c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin"))) %>% 
  ggplot(aes(x = stars, y = brand)) +
  geom_density_ridges(scale = .85) +
  labs(
    x = "Stars (0-5)",
    y = "Brand Name"
  )

distri_most_common
```

The above plots show that all these 5 brands have a peak at around **4 star**. 
For *Nissin*, *Nongshim*, *Mama*, and *Paldo*, they also have a second peak at around **5 star**.

## Brands with only 1 flavor

```{r, echo=FALSE, message=FALSE}
least_common = 
  tidy_ramen %>%
  drop_na(stars) %>%
  group_by(brand) %>%
  mutate(num_brand = n()) %>%
  filter(num_brand == 1) %>%
  select(brand, num_brand, stars)
```

In this dataset, there are `r nrow(least_common)` brands which only have one flavor. 

