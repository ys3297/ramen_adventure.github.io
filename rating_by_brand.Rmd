---
title: "Rating by Brands"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
library(tidyverse)
library(knitr)
library(dplyr)
library(ggridges)
library(plotly)
```


```{r clean, include=FALSE}
tidy_ramen = 
  read_csv("./ramen-ratings.csv") %>% 
  janitor::clean_names() %>% 
  separate(top_ten, into = c("year", "rank"), sep = " #", convert = TRUE) %>% 
  mutate(
    style = factor(style),
    country = factor(country),
    brand = factor(brand),
    stars = as.numeric(stars)
  )
```

---
## Background Introduction 
In this Ramen dataset, there are **`r nrow(count(tidy_ramen, brand))`** brands. In the following adventure, let's explore the varieties and rating of these brands!



## 5 Brands with the Widest Varieties

Here are the 5 ramen brands with largest number of varieties.
```{r, echo=FALSE, message=FALSE, warning=FALSE}
most_common = 
  tidy_ramen %>%
  group_by(brand) %>%
  summarize(num_varieties = n()) %>%
  top_n(5) %>%
  mutate(brand = fct_reorder(brand, num_varieties)) %>%
  plot_ly(x = ~brand, y = ~num_varieties, color = ~brand, type = "bar", 
          text = ~num_varieties, textposition = 'auto', 
          marker = list(color = 'viridis', 
                        line = list(color = 'viridis', width = 1.5))) %>% 
  layout(title = "5 Ramen Brands with the Widest Varieties",
         xaxis = list(title = "Brand Name"),
         yaxis = list(title = "Number of Varieties")) 

most_common
```

<img src="pictures/nissin.jpg" style="width:20%">

As shown in the above plot, *Nissin* is the winner with **381** types of ramen.

 <img src="pictures/nongshim.jpg" style="width:15%"> <img src="pictures/maruchan.png" style="width:15%"> <img src="pictures/mama.jpg" style="width:15%"> <img src="pictures/paldo.png" style="width:15%">
 
The 2nd to 5th brands are *Nongshim*, *Maruchan*, *Mama*, and *Paldo*. Each of them has more than **60** but less than **100** types of ramen.

### Distribution of Rating Stars

```{r, echo=FALSE, message=FALSE}
distri_widest = 
  tidy_ramen %>%
  drop_na(stars) %>%
  filter(brand %in% c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin")) %>%
  mutate(brand = forcats::fct_relevel(brand, c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin"))) %>% 
  ggplot(aes(x = stars, y = brand, color = brand)) +
  geom_density_ridges(scale = .85) +
  labs(
    title = "Rating Stars Distribution among the 5 Brands with the Widest Varieties",
    x = "Stars (0-5)",
    y = "Brand Name"
  )

distri_widest
```

The above plots show that all these 5 brands have a peak at around **4 stars**. For *Nissin*, *Mama*, and *Paldo*, they also have a second peak at around **5 stars**. Compared to other 4 brands, *Nongshim* has a wider peak among **4-5 stars**. These peaks at high rating stars reflect that the 5 brands kept a good quality while producing a large amount of varieties.

## Brands with Only 1 Variety

```{r, echo=FALSE, message=FALSE}
narrowest = 
  tidy_ramen %>%
  drop_na(stars) %>%
  select(brand, stars) %>%
  group_by(brand) %>%
  mutate(num_brand = n()) %>%
  filter(num_brand == 1)
```

In this dataset, there are `r nrow(narrowest)` brands with only one variety 

### Distribution of Rating Stars

```{r, echo=FALSE, message=FALSE}
distri_narrowest = 
  narrowest %>%
  select(brand, stars) %>%
  pivot_longer(
    brand,
    names_to = "observation", 
    values_to = "name") %>%
  ggplot(aes(x = stars, fill = observation)) +
  geom_density(alpha = .5) + 
  viridis::scale_fill_viridis(discrete = TRUE) +
  labs(
    title = "Rating Stars Distribution among Brands with Only 1 Variety",
    x = "Stars (0-5)"
  )

distri_narrowest
```

For ramen brands with only 1 type, there is also a peak at around **4 stars**. This peak reflects that the taste or texture of these ramen was not bad even though these brands were not experienced in producing ramen.

## Brands with Five Stars or Zero Stars

```{r, echo=FALSE, message=FALSE, warning=FALSE}
five_stars =
  tidy_ramen %>%
  select(brand, stars) %>%
  group_by(brand) %>%
  filter(stars == 5)

zero_stars =
  tidy_ramen %>%
  select(brand, stars) %>%
  group_by(brand) %>%
  filter(stars == 0)
```

Among the total 355 brands, `r nrow(count(five_stars, brand)) ` brands have at least one ramen rated 5 stars, while `r nrow(count(zero_stars, brand)) ` brands have at least one ramen rated 0 stars.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
avg_stars = 
  tidy_ramen %>%
  select(brand, stars) %>%
  group_by(brand) %>%
  mutate(avg_star = mean(stars))
```