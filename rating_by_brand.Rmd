---
title: "Rating by Brands"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
library(tidyverse)
library(knitr)
library(dplyr)
library(ggridges)
library(plotly)
library(patchwork)
```


```{r clean, include=FALSE}
tidy_ramen = 
  read_csv("./ramen-ratings.csv") %>% 
  janitor::clean_names() %>% 
  separate(top_ten, into = c("year", "rank"), sep = " #", convert = TRUE) %>% 
  mutate(
    style = factor(style),
    country = factor(country),
    brand = factor(brand),
    stars = as.numeric(stars)
  )
```

---
## Background Introduction 
In this Ramen dataset, there are `r nrow(count(tidy_ramen, brand))` brands. In the following adventure, let's explore the varieties and rating of these brands!

```{r, echo=FALSE, message=FALSE, warning=FALSE}
five_stars =
  tidy_ramen %>%
  select(brand, stars) %>%
  group_by(brand) %>%
  filter(stars == 5)

zero_stars =
  tidy_ramen %>%
  select(brand, stars) %>%
  group_by(brand) %>%
  filter(stars == 0)
```

Among the total 355 brands, `r nrow(count(five_stars, brand)) ` brands have at least one ramen rated 5 stars, while `r nrow(count(zero_stars, brand)) ` brands have at least one ramen rated 0 stars.

<img src="pictures/nissin.jpg" style="width:15%"> <img src="pictures/nongshim.jpg" style="width:15%"> <img src="pictures/maruchan.png" style="width:15%"> <img src="pictures/mama.jpg" style="width:15%"> <img src="pictures/paldo.png" style="width:15%">

## 5 Most Various Brands

```{r, echo=FALSE, message=FALSE, warning=FALSE}
most_various = 
  tidy_ramen %>%
  group_by(brand) %>%
  summarize(num_varieties = n()) %>%
  top_n(5) %>%
  mutate(brand = fct_reorder(brand, num_varieties)) %>%
  plot_ly(x = ~brand, y = ~num_varieties, color = ~brand, type = "bar", 
          text = ~num_varieties, textposition = 'auto', 
          marker = list(color = 'viridis', 
                        line = list(color = 'viridis', width = 1.5))) %>% 
  layout(title = "5 Ramen Brands with the Widest Varieties",
         xaxis = list(title = "Brand Name"),
         yaxis = list(title = "Number of Varieties")) 

most_various
```

As shown in the above plot, *Nissin* is the winner with `r tidy_ramen %>% filter(brand == 'Nissin') %>% summarize(count = n())` types of ramen. The 2nd to 5th brands are *Nongshim*, *Maruchan*, *Mama*, and *Paldo*. Each of them has more than 60 but less than 100 types of ramen.

### Distribution of Rating Stars

```{r, echo=FALSE, message=FALSE}
distri_various = 
  tidy_ramen %>%
  drop_na(stars) %>%
  filter(brand %in% c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin")) %>%
  mutate(brand = forcats::fct_relevel(brand, c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin"))) %>% 
  ggplot(aes(x = brand, y = stars, color = brand)) + 
  geom_boxplot() +
  labs(
    title = "Rating Distribution Plot of the 5 Most Various Brands",
    x = "Brand Name",
    y = "Rating Stars"
  )
distri_various
```

The above boxplots show that the median rating stars of *Nissin*, *Nongshim*, and *Paldo* are close to `4 stars`. The median of  *Mama* and *Maruchan* are lower than `4 stars`. 75% of products of these 5 brands were rated above or equal to `3 Stars`.

Only *Paldo* and *Maruchan* have some ramen products were rated as `0 Stars`.


```{r, echo=FALSE, message=FALSE}
five_stars = 
  tidy_ramen %>%
  drop_na(stars) %>%
  filter(brand %in% c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin"),
         stars == 5) %>%
  mutate(brand = forcats::fct_relevel(brand, c("Paldo", "Mama", "Maruchan", "Nongshim", "Nissin"))) %>% 
  ggplot(aes(x = brand, fill = brand)) + 
  geom_bar(stat = "count") +
  labs(
    title = "Number of 5 Stars Ramen among the 5 Most Various Brands",
    x = "Brand Name",
    y = "Number of 5 Stars Ramen"
  )

five_stars
```

All of these 5 brands have at least one ramen was rated as `5 Stars`. *Nissin* also has the largest number of ramen rated as *5 Stars*.

